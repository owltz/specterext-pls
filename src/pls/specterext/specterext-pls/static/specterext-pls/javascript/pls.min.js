(()=>{var X=Object.defineProperty;var xt=Object.getOwnPropertyDescriptor;var St=Object.getOwnPropertyNames;var vt=Object.prototype.hasOwnProperty;var Pt=(t,n)=>()=>(t&&(n=t(t=0)),n);var kt=(t,n)=>{for(var e in n)X(t,e,{get:n[e],enumerable:!0})},Et=(t,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of St(n))!vt.call(t,o)&&o!==e&&X(t,o,{get:()=>n[o],enumerable:!(r=xt(n,o))||r.enumerable});return t};var Bt=t=>Et(X({},"__esModule",{value:!0}),t);var pt={};kt(pt,{CURVE:()=>L,ProjectivePoint:()=>S,Signature:()=>N,etc:()=>D,getPublicKey:()=>Ct,getSharedSecret:()=>_t,sign:()=>Tt,signAsync:()=>Ht,utils:()=>Ot,verify:()=>Nt});function Ct(t,n=!0){return S.fromPrivateKey(t).toRawBytes(n)}function dt(t,n,e=$){["der","recovered","canonical"].some(u=>u in e)&&d("sign() legacy options not supported");let{lowS:r}=e;r==null&&(r=!0);let o=M(R(t)),i=ot(o),c=V(n),l=[ot(c),i],h=e.extraEntropy;if(h){h===!0&&(h=D.randomBytes(x));let u=R(h);u.length!==x&&d(),l.push(u)}let f=o,a=u=>{let y=lt(u);if(!K(y))return;let E=q(y,g),p=C.mul(y).aff(),b=s(p.x,g);if(b===0n)return;let w=s(E*s(f+s(c*b,g),g),g);if(w===0n)return;let A=w,m=(p.x===b?0:2)|Number(p.y&1n);return r&&J(w)&&(A=s(-w,g),m^=1),new N(b,A,m)};return{seed:F(...l),k2sig:a}}function ht(t){let n=P(x),e=P(x),r=0,o=()=>{n.fill(1),e.fill(0),r=0},i="drbg: tried 1000 values";if(t){let c=(...f)=>D.hmacSha256Async(e,n,...f),l=async(f=P())=>{e=await c(P([0]),f),n=await c(),f.length!==0&&(e=await c(P([1]),f),n=await c())},h=async()=>(r++>=1e3&&d(i),n=await c(),n);return async(f,a)=>{o(),await l(f);let u;for(;!(u=a(await h()));)await l();return o(),u}}else{let c=(...f)=>{let a=O;return a||d("etc.hmacSha256Sync not set"),a(e,n,...f)},l=(f=P())=>{e=c(P([0]),f),n=c(),f.length!==0&&(e=c(P([1]),f),n=c())},h=()=>(r++>=1e3&&d(i),n=c(),n);return(f,a)=>{o(),l(f);let u;for(;!(u=a(h()));)l();return o(),u}}}async function Ht(t,n,e=$){let{seed:r,k2sig:o}=dt(t,n,e);return ht(!0)(r,o)}function Tt(t,n,e=$){let{seed:r,k2sig:o}=dt(t,n,e);return ht(!1)(r,o)}function Nt(t,n,e,r=Rt){let{lowS:o}=r;o==null&&(o=!0),"strict"in r&&d("verify() legacy options not supported");let i,c,l,h=t&&typeof t=="object"&&"r"in t;!h&&R(t).length!==2*x&&d("signature must be 64 bytes");try{i=h?new N(t.r,t.s).assertValidity():N.fromCompact(t),c=M(R(n,x)),l=e instanceof S?e.ok():S.fromHex(e)}catch{return!1}if(!i)return!1;let{r:f,s:a}=i;if(o&&J(a))return!1;let u;try{let E=q(a,g),p=s(c*E,g),b=s(f*E,g);u=C.mulAddQUns(l,p,b).aff()}catch{return!1}return u?s(u.x,g)===f:!1}function _t(t,n,e=!0){return S.fromHex(n).mul(V(t)).toRawBytes(e)}function yt(t){t=R(t);let n=x+8;(t.length<n||t.length>1024)&&d("expected proper params");let e=s(z(t),g-1n)+1n;return Y(e)}var G,H,g,it,ct,L,x,nt,d,j,at,Q,K,ut,P,R,s,et,rt,S,C,I,ft,W,Z,z,U,Y,_,F,q,At,V,J,N,lt,M,ot,st,O,$,Rt,D,Ot,T,Kt,Vt,bt=Pt(()=>{G=2n**256n,H=G-0x1000003d1n,g=G-0x14551231950b75fc4402da1732fc9bebfn,it=0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,ct=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,L={p:H,n:g,a:0n,b:7n,Gx:it,Gy:ct},x=32,nt=t=>s(s(t*t)*t+L.b),d=(t="")=>{throw new Error(t)},j=t=>typeof t=="bigint",at=t=>typeof t=="string",Q=t=>j(t)&&0n<t&&t<H,K=t=>j(t)&&0n<t&&t<g,ut=(t,n)=>!(t instanceof Uint8Array)||typeof n=="number"&&n>0&&t.length!==n?d("Uint8Array expected"):t,P=t=>new Uint8Array(t),R=(t,n)=>ut(at(t)?Z(t):P(t),n),s=(t,n=H)=>{let e=t%n;return e>=0n?e:n+e},et=t=>t instanceof S?t:d("Point expected"),S=class t{constructor(n,e,r){this.px=n,this.py=e,this.pz=r}static fromAffine(n){return new t(n.x,n.y,1n)}static fromHex(n){n=R(n);let e,r=n[0],o=n.subarray(1),i=U(o,0,x),c=n.length;if(c===33&&[2,3].includes(r)){Q(i)||d("Point hex invalid: x not FE");let l=At(nt(i)),h=(l&1n)===1n;(r&1)===1!==h&&(l=s(-l)),e=new t(i,l,1n)}return c===65&&r===4&&(e=new t(i,U(o,x,2*x),1n)),e?e.ok():d("Point is not on curve")}static fromPrivateKey(n){return C.mul(V(n))}get x(){return this.aff().x}get y(){return this.aff().y}equals(n){let{px:e,py:r,pz:o}=this,{px:i,py:c,pz:l}=et(n),h=s(e*l),f=s(i*o),a=s(r*l),u=s(c*o);return h===f&&a===u}negate(){return new t(this.px,s(-this.py),this.pz)}double(){return this.add(this)}add(n){let{px:e,py:r,pz:o}=this,{px:i,py:c,pz:l}=et(n),{a:h,b:f}=L,a=0n,u=0n,y=0n,E=s(f*3n),p=s(e*i),b=s(r*c),w=s(o*l),A=s(e+r),m=s(i+c);A=s(A*m),m=s(p+b),A=s(A-m),m=s(e+o);let B=s(i+l);return m=s(m*B),B=s(p+w),m=s(m-B),B=s(r+o),a=s(c+l),B=s(B*a),a=s(b+w),B=s(B-a),y=s(h*m),a=s(E*w),y=s(a+y),a=s(b-y),y=s(b+y),u=s(a*y),b=s(p+p),b=s(b+p),w=s(h*w),m=s(E*m),b=s(b+w),w=s(p-w),w=s(h*w),m=s(m+w),p=s(b*m),u=s(u+p),p=s(B*m),a=s(A*a),a=s(a-p),p=s(A*b),y=s(B*y),y=s(y+p),new t(a,u,y)}mul(n,e=!0){if(!e&&n===0n)return I;if(K(n)||d("invalid scalar"),this.equals(C))return Vt(n).p;let r=I,o=C;for(let i=this;n>0n;i=i.double(),n>>=1n)n&1n?r=r.add(i):e&&(o=o.add(i));return r}mulAddQUns(n,e,r){return this.mul(e,!1).add(n.mul(r,!1)).ok()}toAffine(){let{px:n,py:e,pz:r}=this;if(this.equals(I))return{x:0n,y:0n};if(r===1n)return{x:n,y:e};let o=q(r);return s(r*o)!==1n&&d("invalid inverse"),{x:s(n*o),y:s(e*o)}}assertValidity(){let{x:n,y:e}=this.aff();return(!Q(n)||!Q(e))&&d("Point invalid: x or y"),s(e*e)===nt(n)?this:d("Point invalid: not on curve")}multiply(n){return this.mul(n)}aff(){return this.toAffine()}ok(){return this.assertValidity()}toHex(n=!0){let{x:e,y:r}=this.aff();return(n?(r&1n)===0n?"02":"03":"04")+_(e)+(n?"":_(r))}toRawBytes(n=!0){return Z(this.toHex(n))}};S.BASE=new S(it,ct,1n);S.ZERO=new S(0n,1n,0n);({BASE:C,ZERO:I}=S),ft=(t,n)=>t.toString(16).padStart(n,"0"),W=t=>Array.from(t).map(n=>ft(n,2)).join(""),Z=t=>{let n=t.length;(!at(t)||n%2)&&d("hex invalid 1");let e=P(n/2);for(let r=0;r<e.length;r++){let o=r*2,i=t.slice(o,o+2),c=Number.parseInt(i,16);(Number.isNaN(c)||c<0)&&d("hex invalid 2"),e[r]=c}return e},z=t=>BigInt("0x"+(W(t)||"0")),U=(t,n,e)=>z(t.slice(n,e)),Y=t=>j(t)&&t>=0n&&t<G?Z(ft(t,2*x)):d("bigint expected"),_=t=>W(Y(t)),F=(...t)=>{let n=P(t.reduce((r,o)=>r+ut(o).length,0)),e=0;return t.forEach(r=>{n.set(r,e),e+=r.length}),n},q=(t,n=H)=>{(t===0n||n<=0n)&&d("no inverse n="+t+" mod="+n);let e=s(t,n),r=n,o=0n,i=1n,c=1n,l=0n;for(;e!==0n;){let h=r/e,f=r%e,a=o-c*h,u=i-l*h;r=e,e=f,o=c,i=l,c=a,l=u}return r===1n?s(o,n):d("no inverse")},At=t=>{let n=1n;for(let e=t,r=(H+1n)/4n;r>0n;r>>=1n)r&1n&&(n=n*e%H),e=e*e%H;return s(n*n)===t?n:d("sqrt invalid")},V=t=>(j(t)||(t=z(R(t,x))),K(t)?t:d("private key out of range")),J=t=>t>g>>1n;N=class t{constructor(n,e,r){this.r=n,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(n){return n=R(n,64),new t(U(n,0,x),U(n,x,2*x))}assertValidity(){return K(this.r)&&K(this.s)?this:d()}addRecoveryBit(n){return new t(this.r,this.s,n)}hasHighS(){return J(this.s)}recoverPublicKey(n){let{r:e,s:r,recovery:o}=this;[0,1,2,3].includes(o)||d("recovery id invalid");let i=M(R(n,32)),c=o===2||o===3?e+g:e;c>=H&&d("q.x invalid");let l=o&1?"03":"02",h=S.fromHex(l+_(c)),f=q(c,g),a=s(-i*f,g),u=s(r*f,g);return C.mulAddQUns(h,a,u)}toCompactRawBytes(){return Z(this.toCompactHex())}toCompactHex(){return _(this.r)+_(this.s)}},lt=t=>{let n=t.length*8-256,e=z(t);return n>0?e>>BigInt(n):e},M=t=>s(lt(t),g),ot=t=>Y(t),st=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,$={lowS:!0},Rt={lowS:!0};D={hexToBytes:Z,bytesToHex:W,concatBytes:F,bytesToNumberBE:z,numberToBytesBE:Y,mod:s,invert:q,hmacSha256Async:async(t,...n)=>{let e=st(),r=e&&e.subtle;if(!r)return d("etc.hmacSha256Async not set");let o=await r.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return P(await r.sign("HMAC",o,F(...n)))},hmacSha256Sync:O,hashToPrivateKey:yt,randomBytes:(t=32)=>{let n=st();return(!n||!n.getRandomValues)&&d("crypto.getRandomValues must be defined"),n.getRandomValues(P(t))}},Ot={normPrivateKeyToScalar:V,isValidPrivateKey:t=>{try{return!!V(t)}catch{return!1}},randomPrivateKey:()=>yt(D.randomBytes(x+8)),precompute(t=8,n=C){return n.multiply(3n),n}};Object.defineProperties(D,{hmacSha256Sync:{configurable:!1,get(){return O},set(t){O||(O=t)}}});T=8,Kt=()=>{let t=[],n=256/T+1,e=C,r=e;for(let o=0;o<n;o++){r=e,t.push(r);for(let i=1;i<2**(T-1);i++)r=r.add(e),t.push(r);e=r.double()}return t},Vt=t=>{let n=rt||(rt=Kt()),e=(a,u)=>{let y=u.negate();return a?y:u},r=I,o=C,i=1+256/T,c=2**(T-1),l=BigInt(2**T-1),h=2**T,f=BigInt(T);for(let a=0;a<i;a++){let u=a*c,y=Number(t&l);t>>=f,y>c&&(y-=h,t+=1n);let E=u,p=u+Math.abs(y)-1,b=a%2!==0,w=y<0;y===0?o=o.add(e(b,n[E])):r=r.add(e(w,n[p]))}return{p:r,f:o}}});var Yt=(bt(),Bt(pt)).default,Zt=typeof WebSocket<"u"?WebSocket:"works-only-in-browser!!!";k.prototype.wait_connected=async function(n){let e=1e3;for(;;)if(this.ws.readyState!==1)await mt(e),e*=1.5;else return};function k(t,n={}){if(!(this instanceof k))return new k(t,n);this.url=t,this.opts=n,n.reconnect==null&&(n.reconnect=!0);let e=this;return e.onfn={},wt(e).catch(r=>{e.onfn.error&&e.onfn.error(r)}),this}function wt(t){return new Promise((n,e)=>{let r=t.ws=new Zt(t.url),o=!1;r.onmessage=i=>{zt(t,i),t.onfn.message&&t.onfn.message(i)},r.onclose=i=>{if(t.onfn.close&&t.onfn.close(i),t.reconnecting)return e(new Error("close during reconnect"));!t.manualClose&&t.opts.reconnect&&gt(t)},r.onerror=i=>{if(t.onfn.error&&t.onfn.error(i),t.reconnecting)return e(new Error("error during reconnect"));t.opts.reconnect&&gt(t)},r.onopen=i=>{t.onfn.open&&t.onfn.open(i),!o&&(o=!0,n(t))}})}function mt(t){return new Promise(n=>setTimeout(n,t))}async function gt(t){let e=100;try{t.reconnecting=!0,await wt(t),t.reconnecting=!1}catch{await mt(e),e*=1.5}}k.prototype.on=function(n,e){return this.onfn[n]=e,this};k.prototype.close=function(){this.ws&&(this.manualClose=!0,this.ws.close())};k.prototype.subscribe=function(n,e){Array.isArray(e)?this.send(["REQ",n,...e]):this.send(["REQ",n,e])};k.prototype.unsubscribe=function(n){this.send(["CLOSE",n])};k.prototype.send=async function(n){await this.wait_connected(),this.ws.send(JSON.stringify(n))};function zt(t,n){let e;try{e=JSON.parse(n.data)}catch(r){console.error("handle_nostr_message",r);return}if(e.length>=2)switch(e[0]){case"EVENT":return e.length<3?void 0:t.onfn.event&&t.onfn.event(e[1],e[2]);case"EOSE":return t.onfn.eose&&t.onfn.eose(e[1]);case"NOTICE":return t.onfn.notice&&t.onfn.notice(...e.slice(1));case"OK":return t.onfn.ok&&t.onfn.ok(...e.slice(1))}}function v(t,n){if(!(this instanceof v))return new v(t,n);this.onfn={},this.relays=[],this.opts=n;for(let e of t)this.add(e);return this}v.prototype.close=function(){for(let n of this.relays)n.close()};v.prototype.on=function(n,e){for(let r of this.relays)this.onfn[n]=e,r.onfn[n]=e.bind(null,r);return this};v.prototype.has=function(n){for(let e of this.relays)if(e.url===n)return!0;return!1};v.prototype.send=function(n,e){let r=e?this.find_relays(e):this.relays;for(let o of r)o.send(n)};v.prototype.setupHandlers=function(){let n=Object.keys(this.onfn);for(let e of n)for(let r of this.relays)r.onfn[e]=this.onfn[e].bind(null,r)};v.prototype.remove=function(n){let e=0;for(let r of this.relays){if(r.url===n)return r.ws&&r.ws.close(),this.relays=this.relays.splice(e,1),!0;e+=1}return!1};v.prototype.subscribe=function(n,e,r){let o=r?this.find_relays(r):this.relays;for(let i of o)i.subscribe(n,e)};v.prototype.unsubscribe=function(n,e){let r=e?this.find_relays(e):this.relays;for(let o of r)o.unsubscribe(n)};v.prototype.add=function(n){if(n instanceof k)return this.has(n.url)?!1:(this.relays.push(n),this.setupHandlers(),!0);if(this.has(n))return!1;let e=k(n,this.opts);return this.relays.push(e),this.setupHandlers(),!0};v.prototype.find_relays=function(n){if(n instanceof k)return[n];if(n.length===0)return[];if(!n[0])throw new Error("what!?");return n[0]instanceof k?n:this.relays.reduce((e,r)=>(n.some(o=>r.url===o)&&e.push(r),e),[])};var qt="32e1827635450ebb3c5a7d12c1f8e7b2b514439ac10a67eef3d9fd9c5c68e245",Dt="wss://relay.damus.io",It="wss://nostr-pub.wellorder.net",Ut=[Dt,It],tt=v(Ut);tt.on("open",t=>{t.subscribe("subid",{limit:2,kinds:[1],authors:[qt]})});tt.on("eose",t=>{t.close()});tt.on("event",(t,n,e)=>{console.log(new Date(e.created_at*1e3).toLocaleString(),e.content)});})();
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
